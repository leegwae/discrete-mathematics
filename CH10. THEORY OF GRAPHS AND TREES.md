# CH10. THEORY OF GRAPHS AND TREES

## 10.1 Trails, Paths, and Circuits

### 10.1.1 Definitions

**Definition**

$G$가 그래프이고 $v$과 $w$가 $G$에 속하는 점들이라고 하자.

**$v$부터 $w$까지의 walk**는 $G$의 인접한 점들과 edge의 유한한 alternating sequence이다. 그러므로 walk는 다음과 같은 형태이다.
$$
v_0e_1v_1e_2...v_{n-1}e_nv_n
$$
$i=1,2,...,n$에 대하여 $v$는 점들을 나타내며, $e$의 edge들을 나타내고 $v_0=v,v_n=w$이다. $v_{i-1}$과 $v_i$는 $e_i$의 endpoint이다. **$v$부터 $v$까지의 trivial walk**는 단일한 점 $v$로 구성되어 있다.



**trail from $v$ to $w$**는 반복된 edge을 포함하지 않는 $v$부터 $w$까지의 walk이다.

**path from $v$ to $w$**는 반복된 점을 포함하지 않는 trail이다.

**close walk**는 동일한 점에서 시작하고 끝나는 walk이다.

**circuit**은 적어도 하나의 edge을 포함하고 반복된 edge을 포함하지 않는 close walk이다.

**simple circuit**은 처음과 마지막을 제외하고 어떤 다른 반복된 점을 포함하지 않는 circuit이다.



### 10.1.2 Subgraph

**Definition**

그래프 $H$는 $H$의 모든 점이 $G$에도 속하고, $H$의 모든 edge이 $G$에도 속하며, $H$의 모든 edge가 $G$에 속하는 것과 같은 endpoints를 가지는 경우, 그리고 오직 이 경우에만 그래프 $G$의 **subgraph**라고 한다.



### 10.1.3 Connectedness

**Definition**

$G$가 그래프라고 하자. $G$에 속하는 **두 개의 점 $v$와 $w$는** $v$부터 $w$까지의 walk가 있는 경우, 그리고 오직 이 경우에만 **connected(연결되었다)**고 한다. 그래프 $G$는 $G$의 주어진 모든 두 점에 대하여, $v$부터 $w$까지의 walk가 있는 경우, 그리고 오직 이 경우에만 **connected(연결되었다)**고 한다. 기호화하면:
$$
G는\ 연결되었다\Leftrightarrow\forall\ G의\ 점\ v와\ w에 대하여,\ \exists\ \mathrm{a\ walk\ from\ }v\mathrm{\ to\ }w
$$


**Lemma 10.1.1**

$G$가 그래프라고 하자.

1. $G$가 connected이면, $G$의 서로 다른 두 점은 path에 의해 connected될 수 있다.
2. 점 $v$와 $w$가 $G$의 circuit의 부분이고 한 edge가 circuit으로부터 제거되면, 여전히 $G$안의 $v$부터 $w$까지의 trail은 존재한다.
3. $G$가 connected이고 $G$가 circuit을 포함하면, circuit의 edge는 disconnecting $G$ 없이 제거될 수 있다.



**Definition[connected component]**

그래프 $H$는 다음과 같은 경우, 그리고 오직 이 경우에만 그래프 $G$의 **connected component**이다.

1. $H$는 $G$의 서브그래프이다.
2. $H$는 connected되어있다; 그리고
3. $G$의 어떤 connected 서브그래프도 서브그래프로서 $H$를 가지지 않고 $H$에 속하지 않은 점이나 edge를 포함하지 않는다.



### 10.1.4 Euler Circuits

**Definition[Euler Circuits]**

$G$가 그래프라고 하자. $G$에 대한 **Euler circuit**은 $G$의 모든 점과 edge를 포함하는 circuit이다. 즉, $G$에 대한 Euler circuit은 적어도 하나의 edge를 가지고, 동일한 점에서 시작하고 끝나며, 적어도 한 번 $G$의 모든 점들을 사용하고, 정확히 한 번 $G$의 모든 edge를 사용하는 $G$의 인접한 점들과 edge들의 sequence이다.



**Theorem 10.1.2**

그래프가 Euler circuit이면, 그래프의 모든 점은 positive even degree이다.



**Contrapositive Version of Theorem 10.1.2**

그래프의 어떤 vertex가 odd degree라면, 그래프는 Euler circuit을 가지지 않는다.



**Theorem 10.1.3**

그래프 $G$가 connected되었고 $G$의 모든 점들의 degree가 positive even integer이면, $G$는 Euler circuit이다.



**Theorem 10.1.4**

그래프 $G$는 $G$가 connected되었고 $G$의 모든 점들이 positive even degree를 가지는 경우, 그리고 오직 이 경우에만 Euler circuit이다.



**Definition**

$G$가 그래프이고, $v$와 $w$가 $G$의 서로 다른 두 점이라고 하자. **$v$부터 $w$까지의 Euler trail**은 $v$에 시작하고, $w$에서 끝나며, $G$의 모든 점을 적어도 한 번 통과하고, $G$의 모든 edge를 정확히 한 번 순회하는 인접한 edge와 점들의 sequence이다.



**Corollary 10.1.5**

$G$가 그래프이고, $v$와 $w$가 $G$의 서로 다른 두 점이라고 하자. $G$가 connected되었고, $v$와 $w$가 odd degree를 가지며, $G$의 다른 모든 점들이 positive even degree를 가지는 경우, 그리고 오직 이 경우에만 $v$부터 $w$까지의 Euler trail이 존재한다.



### 10.1.5 Hamiltonian Circuits

**Definition[Hamiltonian circuit]**

주어진 그래프 $G$에 대하여, $G$에 대한 **Hamiltonian circuit**은 $G$의 모든 점들을 포함하는 simple circuit이다. 즉, $G$에 대한 Hamiltonian circuit은 $G$의 모든 점들이 서로 동일한 처음과 마지막을 제외하고 정확히 한 번 나타나는 인접한 점들과 서로 다른 edge의 sequence이다.



**Proposition 10.1.6**

그래프 $G$가 Hamiltonian circuit이면, $G$는 다음의 특성을 가지는 서브그래프 $H$를 가진다.

1. $H$는 $G$의 모든 점을 가진다.
2. $H$는 connected되었다.
3. $H$는 점들과 동일한 수의 edge를 가진다.
4. $H$의 모든 점들은 degree 2를 가진다.



## 10.2 Matrix Representations of Graphs

### 10.2.1 Matrices

**Definition[Matrix]**

$m\times n$($m$ by $n$으로 읽는다) **matrix $A$ over a set $S$**은 $m$개의 행과 $n$개의 열로 배치된 $S$의 요소의 사각형 배열이다.
$$
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1j} &\cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2j} &\cdots & a_{2n} \\
\vdots & \vdots & &\vdots & &\vdots \\
a_{i1} & a_{i2} & \cdots & a_{ij} &\cdots & a_{in} \\
\vdots & \vdots & &\vdots & &\vdots \\
a_{m1} & a_{m2} & \cdots & a_{mj} &\cdots & a_{mn} \\
\end{bmatrix}
$$
$A=(a_{ij})$로 읽는다.



- $A$의 $i$번째 행은 $[a_{i1}\ a_{i2}\ ...\  a_{in}]$
- $A$의 $j$번째 행은 

$$
\begin{bmatrix}
a_{1j} \\
a_{2j} \\
\vdots\\
a_{mj}
\end{bmatrix}
$$

- $A$의 $i$번째 행과 $j$번째 열의 entry $a_{ij}$는 $A$의 $ij$번째 entry이다.
- $m\times n$ matrix는 크기가 $m\times n$이라고 한다.
- $A=B$는 $A$와 $B$가 같은 크기를 가지고 대응하는 모든 entry가 같은 경우, 그리고 오직 이 경우에만 참이다.
- 행과 열의 개수가 같은 matrix를 **square matrix**라고 한다.
- $A$가 크기가 $n\times n$인 square matrix이면, $A$의 **main diagonal**은 entry $a_{11}, \ a_{22},\cdots, a_{nn}$이다.



### 10.2.2 Matrices and Directed Graphs

**Definition**

$G$가 순서가 있는 점들 $v_1,v_2,...,v_n$으로 이루어진 directed graph(방향 그래프)라고 하자. **adjacency matrix of $G$**는 $n\times n$ matrix **$A={(a_{ij})}$** over the set of nonnegative integers such that
$$
a_{ij}=v_j부터\ v_j까지의\ \mathrm{arrow}의\ 개수\quad(모든\ i,j=1,2,..,n)
$$


### 10.2.3 Matrices and Undirected Graph

**Definition[adjacency matrix]**

$G$가 순서가 있는 점들 $v_1,v_2,...,v_n$으로 이루어진 undirected graph라고 하자. **adjacency matrix of $G$**는 $n\times n$ matrix **$A={(a_{ij})}$** over the set of nonnegative integers such that
$$
a_{ij}=v_j와\ v_j를\ 잇는\ \mathrm{edge}의\ 개수\quad(모든\ i,j=1,2,..,n)
$$
**Definition[symmetric]**

$n\times n$ 크기의 square matrix $A=(a_{ij})$는 모든 $i,h=1,2,\cdots,n$에 대하여 $a_{ij}=a_{ji}$인 경우, 그리고 오직 이 경우에만 **symmetric**하다.



### 10.2.4 Matrices and Connected Components

**Theorem 10.2.1**

그래프 $G$가 connected component $G_1,\ G_2,\ \cdots,\ G_k$를 가졌다고 가정하자. 각각의 connected component $G_i$에 $n$개의 점이 존재하고 이 점들이 연속적으로(consecutively) 숫자를 가지면, $G$의 adjacency matrix는 다음의 형태를 가진다.
$$
\begin{bmatrix}
A_{1} & O & \cdots & O &O & O \\
O & A_{2} & \cdots & O &O & O \\
\vdots & \vdots & &\vdots & &\vdots \\
O & O & \cdots & O &O & O \\
\vdots & \vdots & &\vdots & &\vdots \\
O & O & \cdots & O &O & A_k \\
\end{bmatrix}
$$


### 10.2.5 Matrix Multiplication

**Definition**

matrix $A$와 $B$의 모든 entry는 실수라고 가정하자. $A$의 $i$번째 행에 있는 요소의 개수 $n$은 $B$의 $j$번째 행에 있는 요소의 개수와 같다면, $A$의 $i$번째 행과 $B$의 $j$번째 열의 **scalar product** 혹은 **dot product**은 다음과 같은 실수이다.
$$
\begin{bmatrix}
a_{i1} \ a_{i2}\ \dots\ a_{in}
\end{bmatrix}

\begin{bmatrix}
b_{1j} \\
b_{2j} \\
\vdots \\
b_{nj} \\
\end{bmatrix}

=a_{i1}b_{1j}+a_{i2}b_{2j}+\cdots+a_{in}b_{nj}
$$
**Definition**

$A=(a_{ij})$가 $m\times k$ matrix이고 $B=(b_{ij})$가 $k\times n$ matrix라고 하자. 둘 모두 실수 entry를 가진다. $A$ times $B$의 (matrix) product는 $AB$라고 표기하며, 다음과 같이 정의된 matrix $(c_{ij})$이다.
$$
\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1k} \\
a_{21} & a_{12} & \cdots & a_{2k} \\
\vdots & \vdots & &\vdots\\
a_{i1} & a_{12} & \cdots & a_{ik} \\
\vdots & \vdots & &\vdots\\
a_{m1} & a_{m2} & \cdots & a_{mk} \\
\end{bmatrix}

\begin{bmatrix}
b_{11} & b_{12} & \cdots & b_{1j} &\cdots & b_{1n} \\
b_{21} & b_{22} & \cdots & b_{2j} &\cdots & b_{2n} \\
\vdots & \vdots & &\vdots & &\vdots \\
b_{i1} & b_{i2} & \cdots & b_{ij} &\cdots & b_{in} \\
\vdots & \vdots & &\vdots & &\vdots \\
b_{k1} & b_{k2} & \cdots & b_{kj} &\cdots & b_{kn} \\
\end{bmatrix} \\
=

\begin{bmatrix}
c_{11} & c_{12} & \cdots & c_{1j} &\cdots & c_{1n} \\
c_{21} & c_{22} & \cdots & c_{2j} &\cdots & c_{2n} \\
\vdots & \vdots & &\vdots & &\vdots \\
c_{i1} & c_{i2} & \cdots & c_{ij} &\cdots & c_{in} \\
\vdots & \vdots & &\vdots & &\vdots \\
c_{m1} & c_{m2} & \cdots & c_{mj} &\cdots & c_{mn} \\
\end{bmatrix} \\
$$
 각각의 $i,j=,1,2,\cdots,n$에 대하여
$$
c_{ij}=a_{i1}b_{1j}+a_{i2}{2j}+\cdots+a_{ik}b_{kj}=\sum_{r-1}^k a_{ir}b_{rj}
$$


**Definition[identity matrix]**

각각의 양의 정수 $n$에 대하여, $n\times n$ **identity matrix**는 $I_n=(\delta_{ij})$나 $I$로 표기하며, main diagonal의 모든 entry가 1이나 0인 $n\times n$ matrix이다. 달리 말하여, 모든 $i,j=1,2,\cdots,n$에 대하여
$$
\delta_{ij}=
\begin{cases}
1, &(i=j) \\
0 &(i\neq j)
\end{cases}
$$



**Definition**

$n\times n$ matrix $A$에 대하여, $A$의 제곱은 다음과 같이 정의된다.
$$
\begin{matrix}
A^0&= I&(I는\ n\times n\ \mbox{identity matrix}) \\
A^n&= AA^{n-1}&(모든\ 정수\ n\ge 1) \\
\end{matrix}
$$


### 10.2.6 Counting Walks of Length $N$

- graph의 walk는 edge와 vertices의 alternating sequence로 이루어져있다.
- If repeated  edges are counted each time they occur, sequence의 edge의 개수는 walk의 **length**라고 한다.



## 10.3 Isomorphisms of Graphs

**Definition[ismorphic]**

$G$와 $G^{\prime}$가 각각 vertex 집합 $V(G)$와 $V(G^{\prime})$과 edge set $E(G)$와 $E(G^{\prime})$을 가지는 그래프라고 하자. $G$와 $G^{\prime}$은 각각의 $v\in V(G)$와 $e \in E(G)$에 대하여 다음(10.3.1)이라는 의미에서 $G$와 $G^{\prime}$의 edge=endpoint 함수를 preserve하는 일대일 대응 $g:V(G)\rightarrow V(G^{\prime})$과 $h:E(G)\rightarrow E(G^{\prime})$가 존재하는 경우, 그리고 오직 이 경우에만 **$G$ is isomorphic to $G^{\prime}$**이라고 한다.
$$
v는\ e의\ \mathrm{endpoint}이다\Leftrightarrow g(v)는\ h(e)의\ \mathrm{endpoint}이다.(10.3.1)
$$


**Definition**

프로퍼티 $P$는 주어진 그래프 $G$와 $G^{\prime}$에 대하여, $G$가 프로퍼티 $P$를 가지고 **$G^{\prime}$ is isomorphic to $G$**이면 $G^{\prime}$은 프로퍼티 $P$를 가지는 경우, 그리고 오직 이 경우에만 **invariant for graph isomorphism**이라고 한다.



**Theorem 10.3.2**

다음의 프로퍼티 각각은 invariant for graph isomrphism이다. ($n,m,k$가 모두 nonnegative 정수이다)

1. $n$개의 vertices를 가진다.
2. $m$개의 edge를 가진다.
3. degree가 $k$인 vertex를 가진다.
4. degree가 $k$인 vertex를 $m$개 가진다.
5. 길이가 $k$인 circuit를 가진다.
6. 길이가 $k$인 simple circuit를 가진다.
7. 길이가 $k$인 simple circuit를 $m$개 가진다.
8. connected되었다.
9. Euler circuit을 가진다.
10. Hamiltonian circuit을 가진다.



### 10.3.1 Graph Isomorphism for Simple Graphs

**Definition**

$G$와 $G^{\prime}$이 simple graph이면, $G$의 모든 vertex $u$와 $v$에 대하여 10.3.2라는 의미에서 $G$와 $G^{\prime}$의 edge-endpoint 함수를 preserve하는 $G$의 vertex set $V(G)$부터 $G^{\prime}$의 vertex set $V(G^{\prime})$까지의 일대일 대응 $g$가 존재하는 경우, 그리고 오직 이 경우에만 **$G$ is isomorphic to $G^{\prime}$**이라고 한다. 
$$
\{u,v\}는\ G에\ 속하는\ \mbox{edge}이다. \Leftrightarrow \{g(u),g(v)\}는\ G^{\prime}에\ 속하는\ \mbox{\edge}이다.(10.3.2)
$$


## 10.4 Trees: Examples and Basic Properties

**Definition[tree]**

그래프는 circuit를 가지지 않는 경우, 그리고 오직 이 경우에만 **circuit-free**라고 한다. 그래프는 circuit-free이며 connected인 경우, 그리고 오직 이 경우에만 **tree**라고 한다. **trivial tree**는 단일한 vertex로 이루어진 그래프이다. 그래프는 circuit-free이고 connected되어 있지 않은 경우, **forest**라고 한다.



### 10.4.1 Examples of Trees

#### A Parse Tree

- tree는 특정 basic rule로부터 도출된 문법적으로 맞는 sentence를 보여주는데 사용되기도 한다. 이때 tree를 **syntactic derivation tree**이거나 **parse tree**라고 한다.
- 문법 규칙을 **productions**이라고 한다.
- **syntax**: sentence의 grammatical structure
- **semantics**: word의 의미와 interrelation



### 10.2 Characterizing Trees

**Lemma 10.4.1**

한 개 이상의 vertex를 가진 tree는 적어도 degree가 1인 vertex를 하나 가진다.



**Definition[leaf]**

$T$가 tree라고 하자. $T$가 적어도 두 개의 vertex를 가지면, $T$의 degree가 1인 vertex는 **leaf**(혹은 **terminal vertex**)라고 하며, degree가 1보다 큰 vertex는 **internal vertex**(혹은 **branch vertex**)라고 한다. trivial tree에 있는 유일한 vertex도 **leaf**나 **terminal vertex**라고 한다.



**Theorem 10.4.2**

모든 정수 $n$에 대하여, $n$개의 vertex를 가진 tree는 $n-1$개의 edge를 가진다.



**Lemma 10.4.3**

$G$는 connected graph이고, $C$가 $G$ 안의 circuit라고 하자. 또한 $C$의 edge 중 하나를 $G$에서 뺀다고 하면, 이 남겨진 그래프는 connected되어 있다.



**Corollary 10.4.5**

$G$가 $n$개의 vertex를 가지고 $m$개의 edge를 가진다면, $m$과 $n$이 양의 정수이고 $m\ge n$라 할 때 $G$는 circuit를 가진다.



## 10.5 Rooted Trees

**Definition[rooted tree]**

**rooted tree**는 다른 vertex과 구별되며, **root**라고 불리는 vertex가 있는 tree이다. vertex의 **level**은 해당 vertex와 root 사이의 unique path에 있는 edge의 수이다. rooted tree의 **height**는 tree의 모든 vertex의 최대 level이다. 주어진 root나 rooted tree의 internal vertex $v$에 대하여, $v$의 **children**은 $v$에 인접한 모든 vertex이며, $v$보다 한 레벨 더 루트에서 멀다. $w$가 $v$의 child라면, $v$는 $w$의 **parent**이며, 동일한 parent를 가진 children인 두 개의 서로 다른 vertex는 **siblings**라고 한다. 두 개의 서로 다른 vertex $v$와 $w$에 대하여, $v$가 $w$과 root 사이의 unique path에 있다면(lies on), $v$는 $w$의 **ancestor**이며 $w$는 $v$의 **descendant**라고 한다.



### 10.5.1 Binary Trees

**Definition[binary tree]**

**binary tree**는 모든 parent가 최대 두 개의 children을 가지는 rooted tree이다. binary tree의 각각의 child는 binary tree에서 **left child**이거나 **right child**이며, 모든 parent는 최대 한 개의 left child와 한 개의 right child를 가진다. **full binary tree**는 각각의 parent가 정확히 두 개의 children를 가진다.

주어진 binary tree $T$의 parent $v$에 대하여, $v$가 left child를 가지면, $v$의 **left subtree**는 루트로 $v$의 left child를 가지며,  vertex가 $v$의 left child와 그것의 모든 descendant로 이루어져있고 edge가 left subtree의 vertex와 연결된 $T$의 모든 edge로 이루어진 binary tree이다. $v$의 **right subtree**는 analogously하게 정의되어있다.



**Theorem 10.5.1**

$k$는 양의 정수이고 $T$가 $k$의 internal vertex를 가진 full binary tree이면, $T$는 총 $2k+1$개의 vertex를 가지며, $T$는 $k+1$개의 leave를 가진다.



**Theorem 10.5.2**

모든 정수 $h\ge 0$에 대하여, $T$는 height $h$와 $t$개의 leave를 가진 binary tree를 가지면, $t\le 2^h$이다. 즉, $log_2 t \le h$이다.



**Corollary 10.5.3**

height $h$인 full binary tree는 $2^h$개의 leave를 가진다.



### 10.5.2 Binary Search Trees

binary search tree는 다음 특징들을 가진다: 모든 internal vertex $v$에 대하여, $v$의 left subtree에 있는 모든 key는 $v$에 있는 key보다 적으며, $v$의 right subtree는 모든 key는 $v$의 key보다 크다.

